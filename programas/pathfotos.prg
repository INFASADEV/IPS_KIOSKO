PARAMETERS PEMPRESA,PPARAMETRO,CREAR,xsubcarpeta
TMPATH=""
**PROGRAMA QUE RECIBE EL CODIGO DE EMPRESA Y EL PARAMETRO Y DEVUELDE EL PATH DE FOTOS,
**TOME EN CUENTA QUE SI EL PATH O DIRECTORIO NO EXISTE, LO CREA SI EL PARAMETRO CREAR=1
IF VARTYPE(xsubcarpeta)="L" then
	xsubcarpeta=""
ENDIF 

*!*	PEMPRESA='0001'
*!*	PPARAMETRO='FOTOACTIVO'
IF VARTYPE(CREAR)<>'N'
	CREAR=0
ENDIF

STORE "SELECT * FROM Empresas_Parametros WHERE EMPRESA='&PEMPRESA' AND PARAMETRO='&PPARAMETRO'" TO SELECT1
OKP=SQLEXEC(HCONN,SELECT1,'TMPPARAMETROS')
IF OKP<>1
	MESSAGEBOX("ERROR AL VERIFICAR EL PARAMETRO &PPARAMETRO")
	A=AERROR(MATRIZ)
	MESSAGEBOX(MATRIZ(2),55,'SQL')
	RETURN .F.
ENDIF

SELECT TMPPARAMETROS
COUNT TO TOTP
IF TOTP=0
	MESSAGEBOX("Aun no se han definido los parametros para la empresa: &PEMPRESA y parametro: &PPARAMETRO, por favor definalos para que el proceso sea correcto",64,"PARAMETROS NO CREADOS")
	RETURN .F.
ENDIF

SELECT TMPPARAMETROS
GO top
STORE ALLTRIM(TMPPARAMETROS.VALOR) TO TMPATH

IF !DIRECTORY('&TMPATH')
	IF CREAR=1
	WAIT WINDOW "CREANDO DIRECTORIO &TMPATH" NOWAIT
	MD '&TMPATH'
	ELSE
		MESSAGEBOX("NO EXISTE EL DIRECTORIO ESPECIFICADO",64,"DIRECTORIO NO EXISTENTE")
		RETURN .F.
	ENDIF
ELSE
*!*		WAIT WINDOW "CORRECTO" NOWAIT
ENDIF

RETURN TMPATH


























































